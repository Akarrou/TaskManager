<div class="epic-kanban-container">
  
  <!-- Header avec métriques -->
  <app-epic-header></app-epic-header>
  
  <!-- Section des filtres -->
  <app-search-filters></app-search-filters>
  
  <!-- Métriques en haut -->
  <app-epic-metrics></app-epic-metrics>

  <!-- État de chargement -->
  <div *ngIf="isLoading" class="loading-state">
    <div class="loading-content">
      <mat-icon class="loading-spinner">hourglass_empty</mat-icon>
      <span>Chargement du tableau Kanban...</span>
    </div>
  </div>

  <!-- État d'erreur -->
  <div *ngIf="error" class="error-state">
    <mat-icon class="error-icon">error_outline</mat-icon>
    <h3>Erreur de chargement</h3>
    <p>{{ error }}</p>
    <button mat-raised-button color="primary" (click)="retryLoad()">
      <mat-icon>refresh</mat-icon>
      Réessayer
    </button>
  </div>

  <!-- Tableau Kanban -->
  <div *ngIf="!isLoading && !error" class="kanban-board">
    <div class="kanban-columns">
      <app-kanban-column
        *ngFor="let column of featuresByColumn; trackBy: trackColumn"
        [column]="column"
        [features]="column.features"
        [isLoading]="isLoading"
        [expandedFeatures]="expandedFeatures"
        [featureTasks]="featureTasks"
        [connectedDropLists]="getConnectedDropLists()"
        [highlightedSubtasksByFeature]="highlightedSubtasksByFeature"
        (featureClick)="onFeatureClick($event)"
        (featureEdit)="onFeatureEdit($event)"
        (featureDelete)="onFeatureDelete($event)"
        (toggleExpansion)="onToggleExpansion($event)"
        (taskStatusChange)="onTaskStatusChange($event)"
        (taskPriorityChange)="onTaskPriorityChange($event)"
        (taskEdit)="onTaskEdit($event)"
        (taskDelete)="onTaskDelete($event)"
        class="kanban-column-wrapper">
      </app-kanban-column>
    </div>
  </div>

</div> 
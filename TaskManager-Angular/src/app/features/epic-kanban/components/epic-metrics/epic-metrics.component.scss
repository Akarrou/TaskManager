// T012 - Epic Metrics Dashboard Analytics Styles
.epic-metrics {
  display: flex;
  flex-direction: column;
  gap: 20px;
  padding: 20px;
  min-height: 100vh;
  background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);

  // ==========================================================================
  // HEADER AVANCÉ
  // ==========================================================================
  .metrics-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 20px 24px;
    background: linear-gradient(90deg, #ffffff 0%, #f8fafc 100%);
    border-radius: 12px;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    border: 1px solid #e5e7eb;

    .header-title {
      display: flex;
      align-items: center;
      gap: 12px;

      mat-icon {
        color: #2563eb;
        font-size: 2rem;
      }

      h2 {
        font-size: 1.25rem;
        font-weight: 600;
        color: #1f2937;
        margin: 0;
      }

      .status-chip {
        font-size: 0.75rem;
        font-weight: 500;
        padding: 4px 12px;
        border-radius: 9999px;

        &.status-pending { 
          background-color: #f3f4f6; 
          color: #4b5563; 
        }
        &.status-in_progress { 
          background-color: #dbeafe; 
          color: #1d4ed8; 
        }
        &.status-review { 
          background-color: #e9d5ff; 
          color: #7c3aed; 
        }
        &.status-completed { 
          background-color: #dcfce7; 
          color: #166534; 
        }
        &.status-cancelled { 
          background-color: #fecaca; 
          color: #dc2626; 
        }
        &.status-unknown { 
          background-color: #f3f4f6; 
          color: #6b7280; 
        }
      }
    }

    .header-actions {
      display: flex;
      align-items: center;
      gap: 8px;

      .last-update {
        display: flex;
        align-items: center;
        gap: 4px;
        font-size: 0.75rem;
        color: #6b7280;
        margin-right: 8px;

        mat-icon {
          font-size: 0.875rem;
        }
      }

      .refresh-button {
        transition: transform 0.2s ease;

        &.refreshing {
          animation: spin 1s linear infinite;
        }

        &:hover {
          transform: scale(1.1);
        }
      }
    }
  }

  // ==========================================================================
  // SYSTÈME D'ALERTES
  // ==========================================================================
  .alerts-section {
    .alerts-panel {
      @apply bg-white rounded-lg shadow-sm border border-gray-200;

      .mat-expansion-panel-header {
        @apply bg-gradient-to-r from-red-50 to-orange-50;

        .alert-icon {
          @apply animate-pulse;
        }
      }

      .alerts-list {
        @apply space-y-2 p-2;

        .alert-card {
          @apply border-l-4 shadow-sm transition-all duration-200;

          &.alert-danger {
            @apply border-l-red-500 bg-red-50;
          }

          &.alert-warning {
            @apply border-l-orange-500 bg-orange-50;
          }

          &.alert-info {
            @apply border-l-blue-500 bg-blue-50;
          }

          .alert-content {
            @apply flex items-center justify-between;

            .alert-info {
              @apply flex items-start gap-3 flex-1;

              .alert-text {
                h4 {
                  @apply font-medium text-gray-800 text-sm m-0;
                }

                p {
                  @apply text-gray-600 text-xs mt-1 m-0;
                }

                .alert-time {
                  @apply text-xs text-gray-400 mt-1;
                }
              }
            }

            .alert-actions {
              @apply flex items-center gap-1;
            }
          }
        }
      }
    }
  }

  // ==========================================================================
  // MODE OVERVIEW - KPI DASHBOARD
  // ==========================================================================
  .overview-section {
    .metrics-grid-overview {
      @apply space-y-6;

      .kpi-row {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 24px;
        margin-bottom: 32px;

        @media (max-width: 768px) {
          grid-template-columns: 1fr;
          gap: 16px;
        }

        @media (min-width: 1024px) {
          grid-template-columns: repeat(4, 1fr);
          gap: 20px;
        }

        .kpi-card {
          background-color: white;
          border-radius: 8px;
          box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
          border: 1px solid #e5e7eb;
          transition: all 0.2s ease-in-out;
          
          &:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
          }

          .kpi-content {
            display: flex;
            align-items: center;
            gap: 20px;
            padding: 24px;

            .kpi-chart {
              position: relative;
              flex-shrink: 0;
              width: 100px;
              height: 100px;

              .chart-center-value {
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                display: flex;
                align-items: center;
                justify-content: center;

                .percentage {
                  font-size: 1.25rem;
                  font-weight: bold;
                  color: #1f2937;
                }
              }
            }

            .kpi-icon {
              font-size: 3rem;
              flex-shrink: 0;
            }

            .kpi-details {
              flex: 1;
              min-width: 0;

              h3 {
                font-size: 0.875rem;
                font-weight: 500;
                color: #6b7280;
                margin: 0 0 4px 0;
              }

              .kpi-value {
                font-size: 1.5rem;
                font-weight: bold;
                margin: 4px 0;
              }

              .kpi-label {
                font-size: 0.75rem;
                color: #9ca3af;
              }

              .kpi-breakdown {
                display: flex;
                flex-direction: column;
                gap: 4px;
                margin-top: 8px;

                span {
                  font-size: 0.75rem;

                  &.completed { color: #059669; }
                  &.remaining { color: #f59e0b; }
                }
              }

              .workload-chip {
                font-size: 0.75rem;
                margin-top: 8px;
                padding: 2px 8px;
                border-radius: 9999px;

                &.workload-balanced { 
                  background-color: #dcfce7; 
                  color: #166534; 
                }
                &.workload-unbalanced { 
                  background-color: #fed7aa; 
                  color: #c2410c; 
                }
                &.workload-overloaded { 
                  background-color: #fecaca; 
                  color: #dc2626; 
                }
              }

              .velocity-trend {
                display: flex;
                align-items: center;
                gap: 4px;
                margin-top: 4px;

                .trend-icon {
                  font-size: 0.875rem;

                  &.increasing { color: #10b981; }
                  &.decreasing { color: #ef4444; }
                  &.stable { color: #6b7280; }
                }

                span {
                  font-size: 0.75rem;
                  color: #4b5563;
                  text-transform: capitalize;
                }
              }

              .time-remaining {
                font-size: 0.75rem;
                color: #6b7280;
                margin-top: 4px;
              }
            }
          }
        }
      }

      .velocity-chart-card {
        background-color: white;
        border-radius: 12px;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        border: 1px solid #e5e7eb;
        margin-top: 32px;

        .chart-header {
          padding: 20px 24px 0;
          border-bottom: 1px solid #f3f4f6;

          h3 {
            margin: 0 0 8px 0;
            font-size: 1.125rem;
            font-weight: 600;
            color: #374151;
            display: flex;
            align-items: center;
            gap: 8px;
          }

          .chart-subtitle {
            font-size: 0.875rem;
            color: #6b7280;
            margin: 0;
          }
        }

        .chart-container {
          height: 160px;
          position: relative;
          padding: 24px;

          canvas {
            max-width: 100%;
            max-height: 100%;
          }
        }
      }
    }
  }

  // ==========================================================================
  // MODE DÉTAILLÉ
  // ==========================================================================
  .detailed-section {
    .metrics-grid-detailed {
      display: grid;
      grid-template-columns: 1fr;
      gap: 24px;

      @media (min-width: 1024px) {
        grid-template-columns: repeat(2, 1fr);
        gap: 32px;
      }

      .metric-card {
        background-color: white;
        border-radius: 12px;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        border: 1px solid #e5e7eb;
        transition: all 0.2s ease-in-out;
        padding: 24px;

        &:hover {
          box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
          transform: translateY(-2px);
        }

        .card-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          margin-bottom: 20px;

          .card-icon {
            font-size: 2rem;
            flex-shrink: 0;
          }

          .card-title {
            flex: 1;
            min-width: 0;
            margin-left: 16px;

            h3 {
              font-size: 1.125rem;
              font-weight: 600;
              color: #1f2937;
              margin: 0;
            }

            .card-subtitle {
              font-size: 0.875rem;
              color: #6b7280;
              margin-top: 4px;
            }
          }

          .card-percentage {
            font-size: 2rem;
            font-weight: bold;
          }
        }

        // Progress Card
        &.progress-card {
          .main-progress {
            width: 100%;
            height: 8px;
            border-radius: 9999px;
            margin-bottom: 16px;
            background-color: #f3f4f6;
            overflow: hidden;

            .progress-fill {
              height: 100%;
              background: linear-gradient(90deg, #10b981 0%, #059669 100%);
              border-radius: 9999px;
              transition: width 0.3s ease;
            }
          }

          .progress-breakdown {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;

            .breakdown-item {
              display: flex;
              align-items: center;
              gap: 8px;
              padding: 12px;
              border-radius: 8px;
              background-color: #f9fafb;

              mat-icon {
                font-size: 1.125rem;
              }

              .count {
                font-weight: 600;
                font-size: 1.125rem;
              }

              .label {
                font-size: 0.875rem;
                color: #4b5563;
              }

              &.completed {
                background-color: #ecfdf5;
                mat-icon { color: #059669; }
                .count { color: #059669; }
              }

              &.in-progress {
                background-color: #eff6ff;
                mat-icon { color: #2563eb; }
                .count { color: #2563eb; }
              }

              &.review {
                background-color: #f3e8ff;
                mat-icon { color: #7c3aed; }
                .count { color: #7c3aed; }
              }

              &.pending {
                background-color: #f9fafb;
                mat-icon { color: #4b5563; }
                .count { color: #4b5563; }
              }
            }
          }

          .progress-alerts {
            margin-top: 16px;

            .overdue-chip {
              background-color: #fef2f2;
              color: #dc2626;
              display: flex;
              align-items: center;
              gap: 4px;
              padding: 8px 12px;
              border-radius: 9999px;
              font-size: 0.875rem;
              font-weight: 500;

              mat-icon {
                font-size: 1rem;
                animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
              }
            }
          }
        }

        // Feature Card
        &.feature-card {
          .feature-stats {
            @apply flex justify-around items-center py-4;

            .stat-item {
              @apply text-center;

              .stat-value {
                @apply text-2xl font-bold;
              }

              .stat-label {
                @apply text-sm text-gray-500;
              }
            }
          }

          .feature-metrics {
            .metric-row {
              @apply flex justify-between items-center py-2;

              .metric-label {
                @apply text-sm text-gray-600;
              }

              .metric-value {
                @apply font-semibold;
              }
            }
          }
        }

        // Time Card
        &.time-card {
          .time-breakdown {
            @apply space-y-3;

            .time-item {
              @apply flex justify-between items-center p-3 bg-gray-50 rounded;

              .time-label {
                @apply text-sm text-gray-600;
              }

              .time-value {
                @apply font-semibold;
              }
            }
          }

          .efficiency-metrics {
            @apply space-y-2;

            .efficiency-item {
              @apply flex justify-between items-center;

              .efficiency-label {
                @apply text-sm text-gray-600;
              }

              .efficiency-chip {
                @apply text-xs;

                &.over-budget {
                  @apply bg-red-100 text-red-700;
                }

                &:not(.over-budget) {
                  @apply bg-green-100 text-green-700;
                }
              }

              .projected-date {
                @apply text-sm font-medium text-gray-800;
              }
            }
          }
        }

        // Team Card
        &.team-card {
          .team-summary {
            @apply flex justify-around items-center py-4;

            .team-stat {
              @apply text-center;

              .team-value {
                @apply text-2xl font-bold;
              }

              .team-label {
                @apply text-sm text-gray-500;
              }
            }
          }

          .team-details {
            .top-performer {
              @apply flex items-center gap-3 p-3 bg-yellow-50 rounded;

              .trophy-icon {
                @apply text-xl;
              }

              .performer-info {
                @apply flex flex-col;

                .performer-name {
                  @apply font-semibold text-gray-800;
                }

                .performer-label {
                  @apply text-xs text-gray-500;
                }
              }
            }
          }

          .workload-indicator {
            @apply flex justify-between items-center mt-4;

            .workload-label {
              @apply text-sm text-gray-600;
            }

            .workload-status {
              @apply text-xs;

              &.status-balanced { @apply bg-green-100 text-green-700; }
              &.status-unbalanced { @apply bg-orange-100 text-orange-700; }
              &.status-overloaded { @apply bg-red-100 text-red-700; }
            }
          }
        }
      }
    }
  }

  // ==========================================================================
  // RÉSUMÉ ET PROJECTIONS
  // ==========================================================================
  .summary-card {
    @apply bg-gradient-to-r from-indigo-50 to-purple-50 border border-indigo-200;

    .summary-header {
      @apply flex items-center gap-2;

      mat-icon {
        @apply text-indigo-600;
      }

      h3 {
        @apply text-lg font-semibold text-indigo-800 m-0;
      }
    }

    .summary-grid {
      @apply grid grid-cols-2 lg:grid-cols-4 gap-4 mt-4;

      .summary-item {
        @apply text-center p-4 bg-white rounded-lg shadow-sm;

        .summary-metric {
          @apply flex items-baseline justify-center gap-1;

          .metric-number {
            @apply text-2xl font-bold text-indigo-600;
          }

          .metric-unit {
            @apply text-sm text-gray-500;
          }

          .metric-date {
            @apply text-lg font-bold text-indigo-600;
          }
        }

        .metric-description {
          @apply text-sm text-gray-600 mt-1;
        }
      }
    }
  }

  // ==========================================================================
  // RESPONSIVE DESIGN
  // ==========================================================================
  
  // Mobile
  @media (max-width: 640px) {
    @apply p-2 gap-3;

    .metrics-header {
      @apply flex-col gap-3 p-3;

      .header-actions {
        @apply justify-center;
      }
    }

    .overview-section .kpi-row {
      @apply grid-cols-1 gap-3;
    }

    .detailed-section .metrics-grid-detailed {
      @apply grid-cols-1 gap-4;
    }

    .summary-card .summary-grid {
      @apply grid-cols-2 gap-3;
    }
  }

  // Tablet
  @media (min-width: 641px) and (max-width: 1024px) {
    .overview-section .kpi-row {
      @apply grid-cols-2;
    }

    .detailed-section .metrics-grid-detailed {
      @apply grid-cols-1;
    }
  }

  // ==========================================================================
  // ANIMATIONS ET TRANSITIONS
  // ==========================================================================
  
  .kpi-card, .metric-card, .alert-card {
    @apply transition-all duration-200 ease-in-out;
  }

  .kpi-card:hover, .metric-card:hover {
    @apply transform translate-y-[-2px] shadow-lg;
  }

  // Pulse animation pour alertes critiques
  .alert-danger .alert-icon {
    animation: pulse-danger 2s infinite;
  }

  @keyframes pulse-danger {
    0%, 100% { @apply text-red-600; }
    50% { @apply text-red-400; }
  }

  // Rotation pour refresh button
  .refresh-button.refreshing {
    animation: spin 1s linear infinite;
  }

  @keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
  }

  // Chart animations
  .chart-container {
    @apply transition-all duration-300 ease-in-out;
    
    &:hover {
      @apply transform scale-105;
    }
  }

  // ==========================================================================
  // DARK MODE SUPPORT (préparation)
  // ==========================================================================
  
  &.dark-mode {
    background: linear-gradient(135deg, #1f2937 0%, #111827 100%);

    .metrics-header,
    .kpi-card,
    .metric-card,
    .alert-card,
    .summary-card {
      @apply bg-gray-800 border-gray-700;
    }

    h2, h3, h4 {
      @apply text-gray-100;
    }

    .card-subtitle,
    .kpi-label,
    .metric-label,
    .team-label {
      @apply text-gray-400;
    }
  }
}

// ============================================================================
// RESPONSIVE DESIGN
// ============================================================================
@media (max-width: 1024px) {
  .epic-metrics {
    .metrics-grid .metric-card {
      mat-card-header .card-header {
        .card-title h3 {
          @apply text-xs;
        }
      }
    }
  }
}

@media (max-width: 768px) {
  .epic-metrics {
    .metrics-header {
      @apply flex-col gap-2 items-start;

      .header-actions {
        @apply w-full justify-between;
      }
    }

    .summary-card .summary-grid {
      @apply space-y-2;
    }
  }
}

// ============================================================================
// ANIMATIONS SIMPLES
// ============================================================================
.metric-card {
  transition: all 0.2s ease;

  &:hover {
    @apply shadow-md;
  }
}

.refresh-button.loading {
  mat-icon {
    animation: spin 1s linear infinite;
  }
}

@keyframes spin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

// ============================================================================
// DARK MODE SUPPORT
// ============================================================================
@media (prefers-color-scheme: dark) {
  .epic-metrics {
    .metrics-header {
      @apply bg-gradient-to-r from-gray-800 to-gray-900 border-gray-700;

      .header-title h2 {
        @apply text-gray-100;
      }

      .header-actions .last-update {
        @apply text-gray-300;
      }
    }

    .metric-card {
      @apply bg-gray-800 border-gray-700;

      &.progress-card {
        background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
      }

      &.feature-card {
        background: linear-gradient(135deg, #312e81 0%, #3730a3 100%);
      }

      &.time-card {
        background: linear-gradient(135deg, #14532d 0%, #166534 100%);
      }

      &.velocity-card {
        background: linear-gradient(135deg, #9a3412 0%, #c2410c 100%);
      }

      mat-card-header .card-header .card-title h3 {
        @apply text-gray-100;
      }
    }

    .summary-card {
      @apply bg-gray-800 border-gray-700;
      background: linear-gradient(135deg, #1f2937 0%, #374151 100%);

      .summary-header h3 {
        @apply text-gray-100;
      }

      .summary-grid .summary-item {
        @apply bg-gray-700;
      }
    }
  }
}

// ============================================================================
// CUSTOM PROPERTIES POUR THEMING
// ============================================================================
.epic-metrics {
  --metric-card-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
  --metric-card-hover-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
  --progress-bar-height: 12px;
  --border-radius: 12px;
}

/* T012 - Epic Metrics Dashboard Analytics - Horizontal Accordion Layout */
.epic-metrics-horizontal {
  width: 100%;
  padding: 0;
  background: transparent;

  /* ====================================================================== */
  /* EXPANSION PANELS STYLING */
  /* ====================================================================== */
  
  ::ng-deep .mat-expansion-panel {
    margin-bottom: 16px !important;
    border-radius: 12px !important;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1) !important;
    overflow: hidden;
    
    &:last-child {
      margin-bottom: 0 !important;
    }
    
    .mat-expansion-panel-header {
      padding: 16px 24px !important;
      background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
      border-bottom: 1px solid #e2e8f0;
      
      &:hover {
        background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
      }
      
      .mat-content {
        align-items: center;
      }
      
      .mat-expansion-panel-header-title {
        font-weight: 600;
        color: #1e293b;
        display: flex;
        align-items: center;
        gap: 12px;
        
        mat-icon {
          font-size: 20px;
          width: 20px;
          height: 20px;
          color: #6366f1;
        }
        
        .status-chip,
        .alert-count {
          margin-left: 8px;
          font-size: 11px;
          font-weight: 500;
        }
      }
      
      .mat-expansion-panel-header-description {
        display: flex;
        align-items: center;
        gap: 12px;
        margin-left: auto;
        
        .current-view {
          display: flex;
          align-items: center;
          font-size: 13px;
          color: #64748b;
          font-weight: 500;
          padding: 4px 8px;
          background-color: #f1f5f9;
          border-radius: 6px;
        }
        
        .last-update {
          display: flex;
          align-items: center;
          gap: 4px;
          font-size: 12px;
          color: #64748b;
          
          mat-icon {
            font-size: 14px;
            width: 14px;
            height: 14px;
          }
        }
        
        button {
          &.refresh-button.refreshing {
            mat-icon {
              animation: spin 1s linear infinite;
            }
          }
        }
      }
    }
    
    .mat-expansion-panel-content {
      .mat-expansion-panel-body {
        padding: 24px !important;
        background: #ffffff;
      }
    }
  }

  /* ====================================================================== */
  /* ANALYTICS PANEL SPECIFIQUE */
  /* ====================================================================== */
  
  .analytics-panel {
    .analytics-content {
      min-height: 400px; // Assure une hauteur minimale pour éviter le resize
      
      .overview-section,
      .detailed-section {
        animation: fadeIn 0.3s ease-in-out;
      }
      
      // Summary section intégrée dans Analytics Epic
      .summary-section {
        margin-top: 24px;
        
        .summary-divider {
          margin: 16px 0;
          background-color: #e5e7eb;
        }
        
        .summary-card {
          border-radius: 12px;
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
          border: 1px solid #e5e7eb;
          
          mat-card-header {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border-bottom: 1px solid #e5e7eb;
            padding: 16px 20px !important;
            
            .summary-header {
              display: flex;
              align-items: center;
              gap: 12px;
              
              mat-icon {
                font-size: 24px;
                width: 24px;
                height: 24px;
                color: #0ea5e9;
              }
              
              h3 {
                margin: 0;
                font-size: 16px;
                font-weight: 600;
                color: #1e293b;
              }
            }
          }
          
          mat-card-content {
            padding: 20px !important;
          }
          
          .summary-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            
            .summary-item {
              text-align: center;
              padding: 16px;
              border-radius: 8px;
              background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
              border: 1px solid #e2e8f0;
              transition: all 0.3s ease;
              
              &:hover {
                transform: translateY(-1px);
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
              }
              
              .summary-value {
                font-size: 28px;
                font-weight: 700;
                margin-bottom: 6px;
                
                &.text-blue-600 { color: #2563eb; }
                &.text-orange-500 { color: #f97316; }
                &.text-purple-600 { color: #9333ea; }
                &.text-green-600 { color: #16a34a; }
              }
              
              .summary-label {
                font-size: 13px;
                color: #6b7280;
                font-weight: 500;
                line-height: 1.4;
              }
            }
          }
        }
      }
    }
  }

  /* ====================================================================== */
  /* STATUS CHIPS & ALERTS */
  /* ====================================================================== */
  
  .status-chip {
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 10px;
    font-weight: 600;
    text-transform: uppercase;
    
    &.status-draft { background-color: #fbbf24; color: #92400e; }
    &.status-active { background-color: #34d399; color: #065f46; }
    &.status-completed { background-color: #60a5fa; color: #1d4ed8; }
    &.status-paused { background-color: #f87171; color: #b91c1c; }
  }
  
  .alert-count {
    background-color: #fee2e2;
    color: #dc2626;
    padding: 2px 6px;
    border-radius: 8px;
    font-size: 10px;
    font-weight: 600;
  }

  /* ====================================================================== */
  /* ALERTS PANEL */
  /* ====================================================================== */
  
  .alerts-panel {
    .alerts-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
      
      .alert-card {
        border-radius: 8px;
        border-left: 4px solid #e5e7eb;
        
        &.alert-danger { border-left-color: #ef4444; }
        &.alert-warning { border-left-color: #f59e0b; }
        &.alert-info { border-left-color: #3b82f6; }
        
        .alert-content {
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
          
          .alert-info {
            display: flex;
            gap: 12px;
            flex: 1;
            
            mat-icon {
              margin-top: 2px;
            }
            
            .alert-text {
              h4 {
                margin: 0 0 4px 0;
                font-weight: 600;
                color: #1f2937;
              }
              
              p {
                margin: 0 0 4px 0;
                color: #6b7280;
                font-size: 14px;
              }
              
              .alert-time {
                font-size: 12px;
                color: #9ca3af;
              }
            }
          }
        }
      }
    }
  }

  /* ====================================================================== */
  /* OVERVIEW SECTION */
  /* ====================================================================== */
  
  .overview-section {
    .metrics-grid-overview {
      display: flex;
      flex-direction: column;
      gap: 24px;
      
      .kpi-row {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 20px;
        
        .kpi-card {
          border-radius: 12px;
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
          border: 1px solid #e5e7eb;
          transition: all 0.3s ease;
          
          &:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
          }
          
          mat-card-content {
            padding: 20px !important;
          }
          
          .kpi-content {
            display: flex;
            align-items: center;
            gap: 16px;
            
            .kpi-chart {
              position: relative;
              flex-shrink: 0;
              
              .chart-center-value {
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                text-align: center;
                
                .percentage {
                  font-size: 18px;
                  font-weight: 700;
                  color: #1e293b;
                }
              }
            }
            
            .kpi-icon {
              font-size: 48px;
              width: 48px;
              height: 48px;
              flex-shrink: 0;
            }
            
            .kpi-details {
              flex: 1;
              
              h3 {
                margin: 0 0 8px 0;
                font-size: 14px;
                font-weight: 600;
                color: #6b7280;
                text-transform: uppercase;
                letter-spacing: 0.5px;
              }
              
              .kpi-value {
                font-size: 24px;
                font-weight: 700;
                margin-bottom: 4px;
              }
              
              .kpi-label {
                font-size: 12px;
                color: #9ca3af;
              }
              
              .kpi-breakdown {
                display: flex;
                flex-direction: column;
                gap: 2px;
                
                span {
                  font-size: 12px;
                  
                  &.completed { color: #059669; }
                  &.remaining { color: #d97706; }
                }
              }
              
              .workload-chip {
                margin-top: 4px;
                font-size: 10px;
                
                &.workload-balanced { background-color: #d1fae5; color: #065f46; }
                &.workload-unbalanced { background-color: #fef3c7; color: #92400e; }
                &.workload-overloaded { background-color: #fee2e2; color: #991b1b; }
              }
              
              .velocity-trend {
                display: flex;
                align-items: center;
                gap: 4px;
                font-size: 12px;
                color: #6b7280;
                
                .trend-icon {
                  font-size: 16px;
                  width: 16px;
                  height: 16px;
                  
                  &.increasing { color: #059669; }
                  &.decreasing { color: #dc2626; }
                  &.stable { color: #d97706; }
                }
              }
              
              .time-remaining {
                font-size: 12px;
                color: #6b7280;
              }
            }
          }
        }
      }
      
      .velocity-chart-card {
        border-radius: 12px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        border: 1px solid #e5e7eb;
        
        .chart-header {
          padding: 20px 20px 0 20px;
          
          h3 {
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 0 0 4px 0;
            font-size: 16px;
            font-weight: 600;
            color: #1e293b;
            
            mat-icon {
              color: #f59e0b;
            }
          }
          
          .chart-subtitle {
            margin: 0;
            font-size: 12px;
            color: #6b7280;
          }
        }
        
        .chart-container {
          padding: 20px;
          height: 160px;
        }
      }
    }
  }

  /* ====================================================================== */
  /* DETAILED SECTION */
  /* ====================================================================== */
  
  .detailed-section {
    .metrics-grid-detailed {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 20px;
      
      .metric-card {
        border-radius: 12px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        border: 1px solid #e5e7eb;
        
        mat-card-header {
          background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
          border-bottom: 1px solid #e5e7eb;
          padding: 16px 20px !important;
          
          .card-header {
            display: flex;
            align-items: center;
            gap: 12px;
            width: 100%;
            
            .card-icon {
              font-size: 24px;
              width: 24px;
              height: 24px;
            }
            
            .card-title {
              flex: 1;
              
              h3 {
                margin: 0 0 2px 0;
                font-size: 16px;
                font-weight: 600;
                color: #1e293b;
              }
              
              .card-subtitle {
                font-size: 12px;
                color: #6b7280;
                margin: 0;
              }
            }
            
            .card-percentage {
              font-size: 24px;
              font-weight: 700;
            }
          }
        }
        
        mat-card-content {
          padding: 20px !important;
        }
        
        .main-progress {
          margin-bottom: 16px;
          height: 8px;
          border-radius: 4px;
        }
        
        .progress-breakdown {
          display: grid;
          grid-template-columns: repeat(2, 1fr);
          gap: 12px;
          
          .breakdown-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px;
            border-radius: 6px;
            background-color: #f8fafc;
            
            mat-icon {
              font-size: 16px;
              width: 16px;
              height: 16px;
            }
            
            .count {
              font-weight: 600;
              color: #1e293b;
            }
            
            .label {
              font-size: 12px;
              color: #6b7280;
            }
            
            &.completed { background-color: #ecfdf5; mat-icon { color: #059669; } }
            &.in-progress { background-color: #fef3c7; mat-icon { color: #d97706; } }
            &.review { background-color: #dbeafe; mat-icon { color: #2563eb; } }
            &.pending { background-color: #f3f4f6; mat-icon { color: #6b7280; } }
          }
        }
        
        .progress-alerts {
          margin-top: 12px;
          
          .overdue-chip {
            background-color: #fee2e2;
            color: #dc2626;
            font-size: 12px;
            
            mat-icon {
              font-size: 14px;
              width: 14px;
              height: 14px;
            }
          }
        }
        
        .feature-stats,
        .team-stats {
          display: flex;
          justify-content: space-around;
          margin-bottom: 16px;
          
          .stat-item {
            text-align: center;
            
            .stat-value {
              font-size: 24px;
              font-weight: 700;
              margin-bottom: 4px;
            }
            
            .stat-label {
              font-size: 12px;
              color: #6b7280;
            }
          }
        }
        
        .time-metrics,
        .feature-metrics {
          .metric-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #f1f5f9;
            
            &:last-child {
              border-bottom: none;
            }
            
            .metric-label {
              font-size: 14px;
              color: #6b7280;
            }
            
            .metric-value {
              font-weight: 600;
              color: #1e293b;
            }
          }
        }
      }
    }
  }



  /* ====================================================================== */
  /* RESPONSIVE DESIGN */
  /* ====================================================================== */
  
  @media (max-width: 1024px) {
    .overview-section .metrics-grid-overview .kpi-row {
      grid-template-columns: repeat(2, 1fr);
    }
    
    .detailed-section .metrics-grid-detailed {
      grid-template-columns: repeat(2, 1fr);
    }
    
    .analytics-panel .analytics-content .summary-section .summary-card .summary-stats {
      grid-template-columns: repeat(2, 1fr);
    }
  }
  
  @media (max-width: 768px) {
    .overview-section .metrics-grid-overview .kpi-row,
    .detailed-section .metrics-grid-detailed {
      grid-template-columns: 1fr;
    }
    
    .analytics-panel .analytics-content .summary-section .summary-card .summary-stats {
      grid-template-columns: repeat(2, 1fr);
    }
    
    ::ng-deep .mat-expansion-panel .mat-expansion-panel-header {
      padding: 12px 16px !important;
      
      .mat-expansion-panel-header-description {
        flex-direction: column;
        align-items: flex-end;
        gap: 8px;
        
        .current-view {
          font-size: 11px;
          padding: 2px 6px;
        }
        
        .last-update {
          font-size: 11px;
        }
      }
    }
  }
  
  @media (max-width: 480px) {
    ::ng-deep .mat-expansion-panel .mat-expansion-panel-content .mat-expansion-panel-body {
      padding: 16px !important;
    }
    
    .overview-section .metrics-grid-overview .kpi-row .kpi-card .kpi-content {
      flex-direction: column;
      text-align: center;
      gap: 12px;
    }
    
    .analytics-panel .analytics-content {
      min-height: 300px; // Hauteur réduite pour mobile
      
      .summary-section .summary-card .summary-stats {
        grid-template-columns: 1fr;
      }
    }
  }

  /* ====================================================================== */
  /* ANIMATIONS */
  /* ====================================================================== */
  
  @keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
  }
  
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }
  
  .alert-card,
  .kpi-card,
  .metric-card {
    animation: fadeIn 0.3s ease-out;
  }
} 
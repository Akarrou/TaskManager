<div class="epic-metrics">

  <!-- HEADER SIMPLIFIÉ -->
  <div class="metrics-header">
    <div class="header-title">
      <mat-icon>analytics</mat-icon>
      <h2>Métriques Epic</h2>
    </div>
    <div class="header-actions">
      <span class="last-update text-xs text-gray-600">
        <mat-icon>access_time</mat-icon>
        À l'instant
      </span>
      <button mat-icon-button class="refresh-button" (click)="onRefresh()" matTooltip="Actualiser">
        <mat-icon>refresh</mat-icon>
      </button>
    </div>
  </div>

  <!-- MÉTRIQUES GRID SIMPLIFIÉ -->
  <div class="metrics-grid">
    
    <!-- CARD 1: PROGRESSION -->
    <mat-card class="metric-card progress-card">
      <mat-card-header>
        <div class="card-header">
          <mat-icon class="card-icon text-blue-600">donut_small</mat-icon>
          <div class="card-title">
            <h3>Progression</h3>
            <div class="card-subtitle">Tâches terminées</div>
          </div>
          <div class="card-percentage text-blue-600">{{ calculatedMetrics.progressPercentage }}%</div>
        </div>
      </mat-card-header>
      <mat-card-content>
        <mat-progress-bar 
          class="main-progress" 
          [value]="calculatedMetrics.progressPercentage"
          color="primary">
        </mat-progress-bar>
        
        <div class="progress-breakdown">
          <div class="breakdown-item completed">
            <mat-icon>check_circle</mat-icon>
            <span class="count">{{ calculatedMetrics.completedTasks }}</span>
            <span class="label">Terminé</span>
          </div>
          <div class="breakdown-item in-progress">
            <mat-icon>hourglass_empty</mat-icon>
            <span class="count">{{ calculatedMetrics.inProgressTasks }}</span>
            <span class="label">En cours</span>
          </div>
          <div class="breakdown-item pending">
            <mat-icon>schedule</mat-icon>
            <span class="count">{{ calculatedMetrics.pendingTasks }}</span>
            <span class="label">En attente</span>
          </div>
          <div class="breakdown-item cancelled">
            <mat-icon>cancel</mat-icon>
            <span class="count">{{ calculatedMetrics.cancelledTasks }}</span>
            <span class="label">Annulé</span>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- CARD 2: FEATURES -->
    <mat-card class="metric-card feature-card">
      <mat-card-header>
        <div class="card-header">
          <mat-icon class="card-icon text-purple-600">view_module</mat-icon>
          <div class="card-title">
            <h3>Features</h3>
            <div class="card-subtitle">Répartition par feature</div>
          </div>
        </div>
      </mat-card-header>
      <mat-card-content>
        <div class="feature-stats">
          <div class="stat-item">
            <div class="stat-value text-purple-600">{{ calculatedMetrics.totalFeatures }}</div>
            <div class="stat-label">Total</div>
          </div>
          <div class="stat-item">
            <div class="stat-value text-green-600">{{ calculatedMetrics.completedFeatures }}</div>
            <div class="stat-label">Terminées</div>
          </div>
          <div class="stat-item">
            <div class="stat-value text-orange-500">{{ calculatedMetrics.inProgressFeatures }}</div>
            <div class="stat-label">En cours</div>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- CARD 3: TEMPS -->
    <mat-card class="metric-card time-card">
      <mat-card-header>
        <div class="card-header">
          <mat-icon class="card-icon text-green-600">schedule</mat-icon>
          <div class="card-title">
            <h3>Suivi temporel</h3>
            <div class="card-subtitle">Estimation vs réalisé</div>
          </div>
        </div>
      </mat-card-header>
      <mat-card-content>
        <div class="time-breakdown">
          <div class="time-item">
            <span class="time-label">Estimé</span>
            <span class="time-value text-blue-600">{{ calculatedMetrics.estimatedHours }}h</span>
          </div>
          <div class="time-item">
            <span class="time-label">Réalisé</span>
            <span class="time-value text-green-600">{{ calculatedMetrics.actualHours }}h</span>
          </div>
          <div class="time-item">
            <span class="time-label">Restant</span>
            <span class="time-value text-orange-500">{{ calculatedMetrics.estimatedHours - calculatedMetrics.actualHours }}h</span>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- CARD 4: VÉLOCITÉ -->
    <mat-card class="metric-card velocity-card">
      <mat-card-header>
        <div class="card-header">
          <mat-icon class="card-icon text-orange-600">trending_up</mat-icon>
          <div class="card-title">
            <h3>Vélocité</h3>
            <div class="card-subtitle">Performance équipe</div>
          </div>
        </div>
      </mat-card-header>
      <mat-card-content>
        <div class="velocity-stats">
          <div class="velocity-item">
            <span class="velocity-label">Tâches/jour</span>
            <span class="velocity-value text-orange-600">{{ calculatedMetrics.tasksPerDay }}</span>
          </div>
          <div class="velocity-item">
            <span class="velocity-label">Tendance</span>
            <mat-chip class="trend-stable">Stable</mat-chip>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

  </div>

  <!-- RÉSUMÉ SIMPLIFIÉ -->
  <mat-card class="summary-card">
    <mat-card-header>
      <div class="summary-header">
        <mat-icon>summarize</mat-icon>
        <h3>Résumé de l'epic</h3>
      </div>
    </mat-card-header>
    <mat-card-content>
      <div class="summary-grid">
        <div class="summary-item">
          <div class="summary-metric">
            <span class="metric-number">{{ calculatedMetrics.totalTasks - calculatedMetrics.completedTasks }}</span>
            <span class="metric-unit">tâches</span>
          </div>
          <div class="metric-description">restantes à terminer</div>
        </div>
        
        <div class="summary-item">
          <div class="summary-metric">
            <span class="metric-number">{{ calculatedMetrics.estimatedHours - calculatedMetrics.actualHours }}</span>
            <span class="metric-unit">h</span>
          </div>
          <div class="metric-description">de travail estimé restant</div>
        </div>
      </div>
    </mat-card-content>
  </mat-card>

</div> 
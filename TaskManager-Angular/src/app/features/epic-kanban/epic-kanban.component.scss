@use "../../styles/variables" as v;
@use "../../styles/mixins" as m;
@import "./styles/kanban-variables";

// ============================================================================
// EPIC KANBAN - Global Container & States
// Author: TaskManager AI
// Date: 2024-07-15
// Refactor: T018 - UI Color & Style Harmonization
// ============================================================================

.epic-kanban-container {
  min-height: 100vh;
  background-color: v.$background-color-page;
  padding: v.$space-4;

  // ============================================================================
  // LOADING STATE
  // ============================================================================
  .loading-state {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: v.$space-10;
    color: v.$text-color-medium;

    .loading-spinner {
      font-size: 2.5rem;
      margin-bottom: v.$space-4;
      animation: spin 1.5s linear infinite;
    }

    span {
      font-size: v.$font-size-lg;
    }
  }

  // ============================================================================
  // ERROR STATE
  // ============================================================================
  .error-state {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    max-width: 480px;
    margin: 0 auto;
    padding: v.$space-8;
    background-color: v.$danger-bg;
    border: 1px solid v.$danger-border;
    border-radius: v.$border-radius-lg;

    .error-icon {
      font-size: 3rem;
      color: v.$error-color;
      margin-bottom: v.$space-4;
    }

    h3 {
      font-size: v.$font-size-2xl;
      font-weight: v.$font-weight-bold;
      color: v.$danger-text;
      margin-bottom: v.$space-2;
    }

    p {
      color: v.$text-color-medium;
      margin-bottom: v.$space-6;
    }

    button {
      background-color: v.$primary-color;
      color: v.$text-color-inverted;
    }
  }

  // ============================================================================
  // EMPTY STATE
  // ============================================================================
  .empty-state {
    @apply flex flex-col items-center justify-center min-h-screen text-center max-w-md mx-auto;

    .empty-icon {
      @apply text-6xl text-gray-400 mb-4;
    }

    h3 {
      @apply text-2xl font-bold text-gray-800 mb-2;
    }

    p {
      @apply text-gray-600 mb-6;
    }
  }

  // ============================================================================
  // EPIC BOARD MAIN LAYOUT
  // ============================================================================
  .epic-board {
    max-width: 100%;

    // ========================================================================
    // METRICS PANEL HORIZONTAL (NEW LAYOUT)
    // ========================================================================
    .metrics-panel-horizontal {
      @apply w-full mb-6;
    }

    .kanban-board-content {
      margin-top: v.$space-6;

      // ========================================================================
      // KANBAN COLUMNS CONTAINER (DESKTOP DEFAULT)
      // ========================================================================
      .kanban-columns-container {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: v.$space-4;
        min-height: calc(100vh - 400px);

        .kanban-column {
          width: 100%;
        }
      }
    }
  }
}

// ============================================================================
// RESPONSIVE BREAKPOINTS T010
// ============================================================================

// Large Desktop (>1200px) - 4 colonnes côte à côte
@media (min-width: 1201px) {
  .epic-kanban-container {
    .epic-board {
      .metrics-panel-horizontal {
        @apply w-full mb-8;
      }

      .kanban-board-content {
        .kanban-columns-container {
          @apply grid-cols-4 gap-6;
        }
      }
    }
  }
}

// Tablet (768px-1200px) - 2 colonnes en grille 2x2
@media (max-width: 1200px) and (min-width: 769px) {
  .epic-kanban-container {
    padding: v.$space-3;

    .epic-board {
      .metrics-panel-horizontal {
        @apply w-full mb-6;
      }

      .kanban-board-content {
        .kanban-columns-container {
          grid-template-columns: repeat(2, 1fr);
          gap: v.$space-4;
          min-height: calc(100vh - 350px);
        }
      }
    }
  }
}

// Mobile (<768px) - 1 colonne stack vertical
@media (max-width: 768px) {
  .epic-kanban-container {
    padding: v.$space-2;

    .epic-board {
      .metrics-panel-horizontal {
        @apply w-full mb-4;
      }

      .kanban-board-content {
        .kanban-columns-container {
          grid-template-columns: 1fr;
          gap: v.$space-3;
          min-height: auto;
        }
      }
    }
  }
}

// Small Mobile (<480px) - Optimisation pour très petits écrans
@media (max-width: 480px) {
  .epic-kanban-container {
    padding: v.$space-1;

    .epic-board {
      .metrics-panel-horizontal {
        @apply w-full mb-3;
      }

      .kanban-board-content {
        .kanban-columns-container {
          @apply gap-2;
        }
      }
    }
  }
}

// ============================================================================
// CUSTOM SCROLLBAR STYLING
// ============================================================================
.kanban-columns-container {
  overflow-y: auto;
  scrollbar-width: thin;
  scrollbar-color: v.$border-color-medium v.$background-color-light;

  &::-webkit-scrollbar {
    width: 6px;
  }

  &::-webkit-scrollbar-track {
    background: v.$background-color-light;
    border-radius: 3px;
  }

  &::-webkit-scrollbar-thumb {
    background: v.$border-color-medium;
    border-radius: 3px;

    &:hover {
      background: v.$secondary-color-light;
    }
  }
}

// ============================================================================
// TRANSITIONS ET ANIMATIONS
// ============================================================================
.kanban-columns-container {
  transition: all 0.3s v.$transition-timing-function;

  .kanban-column {
    transition: all 0.2s ease-in-out;
  }
}

// ============================================================================
// PRINT STYLES (BONUS)
// ============================================================================
@media print {
  .epic-kanban-container {
    .epic-board {
      .kanban-board-content {
        display: block;

        .kanban-columns-container {
          grid-template-columns: repeat(2, 1fr);
          font-size: v.$font-size-sm;
        }

        .metrics-panel {
          @apply hidden; // Masquer les métriques à l'impression
        }
      }
    }
  }
}

// Keyframes for animations
@keyframes spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

:host {
  display: block;
}

.features-list {
  display: flex;
  flex-direction: column;
  gap: v.$space-4;
}

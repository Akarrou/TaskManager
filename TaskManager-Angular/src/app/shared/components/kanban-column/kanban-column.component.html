<div class="kanban-column"
  [class.status-pending]="column.statusValue === 'pending'"
  [class.status-in_progress]="column.statusValue === 'in_progress'"
  [class.status-review]="column.statusValue === 'review'"
  [class.status-completed]="column.statusValue === 'completed'">

  <!-- Column Header -->
  <div class="column-header">
    <div class="header-left">
      <mat-icon class="column-icon">{{ getColumnIcon() }}</mat-icon>
      <h3 class="column-title">{{ column.title }}</h3>
    </div>

    <div class="header-actions">
      <button mat-icon-button
        class="toggle-button"
        (click)="onToggleCollapse()"
        [attr.aria-expanded]="!column.isCollapsed"
        aria-label="Réduire ou étendre la colonne"
        matTooltip="Réduire / Étendre">
        <mat-icon>{{ column.isCollapsed ? 'unfold_more' : 'unfold_less' }}</mat-icon>
      </button>
    </div>
  </div>

  <!-- Column Content -->
  <div class="column-content"
    [class.collapsed]="column.isCollapsed"
    cdkDropList
    [id]="column.id"
    [cdkDropListData]="items"
    [cdkDropListConnectedTo]="connectedDropLists"
    (cdkDropListDropped)="onDrop($event)">

    <!-- Loading State -->
    <div *ngIf="isLoading"
      class="loading-state">
      <mat-icon class="spin">hourglass_empty</mat-icon>
      <span>Chargement...</span>
    </div>

    <!-- Items List -->
    <div *ngIf="!isLoading"
      class="features-list">

      <!-- Item Cards -->
      <div *ngFor="let item of items; trackBy: trackItem"
        cdkDrag
        [cdkDragData]="item">

        <!-- Drag Preview (optional custom preview) -->
        <div *cdkDragPreview
          class="drag-preview">
          <div class="feature-preview">
            <span class="feature-number"
              *ngIf="item.task_number">#{{ item.type_icon }}{{ item.task_number }}</span>
            <span class="feature-title">{{ item.title }}</span>
          </div>
        </div>

        <!-- Drag Placeholder -->
        <div *cdkDragPlaceholder
          class="drag-placeholder">
          <div class="placeholder-content">
            <mat-icon>drag_indicator</mat-icon>
            <span>Déposer ici</span>
          </div>
        </div>

        <app-kanban-card [item]="item"
          [showProgress]="true"
          (itemEdit)="onItemEdit($event)"
          (itemDelete)="onItemDelete($event)"
          (itemClick)="onItemClick($event)">
        </app-kanban-card>
      </div>

      <!-- Empty State -->
      <div *ngIf="items.length === 0 && !isLoading"
        class="empty-state">
        <mat-icon>inbox</mat-icon>
        <span>Aucun élément</span>
        <small class="drop-hint">Glissez un élément ici</small>
      </div>

    </div>
  </div>

</div>

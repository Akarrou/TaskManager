---
description: Fragment centralisÃ© pour toutes les validations communes du systÃ¨me TaskManager
globs: ["**/*.mdc"]
alwaysApply: false
---

# ğŸ”„ Fragment Validation Commune

## ğŸ¯ Objectif

Centraliser toutes les validations rÃ©pÃ©titives pour Ã©viter les redondances et garantir la cohÃ©rence.

## ğŸ“‹ Validation MCP Supabase

### Test de ConnectivitÃ© Standard

```javascript
// Test de connectivitÃ© MCP Supabase
function testSupabaseConnectivity() {
  try {
    const projects = await mcp_supabase_list_projects();
    return { success: true, mode: 'online' };
  } catch (error) {
    return { success: false, mode: 'offline', error: error.message };
  }
}
```

### ProcÃ©dure UnifiÃ©e

1. **Tester la connectivitÃ©** avec `list_projects()`
2. **Si Ã©chec** : Basculer automatiquement vers le mode dÃ©gradÃ©
3. **Notifier** l'utilisateur du mode actuel
4. **Continuer** le workflow sans bloquer

## ğŸ“ Validation Utilisateur Standard

### Template de Confirmation

```markdown
## ğŸ” Validation Requise

**Contexte :** {CONTEXT}
**Action proposÃ©e :** {ACTION}

### ğŸ“‹ RÃ©capitulatif

{SUMMARY}

### âš ï¸ Points d'Attention

{WARNINGS}

**Souhaitez-vous poursuivre ?**

- âœ… **Oui** : Lancer l'exÃ©cution
- âŒ **Non** : Annuler et revoir le plan
- ğŸ”„ **RÃ©viser** : Modifier le plan avant exÃ©cution
```

## ğŸ” Validation Anti-Doublon

### ProcÃ©dure UnifiÃ©e

1. **Rechercher** dans Supabase (slug, titre, tags)
2. **Fallback** : Rechercher dans `@/PRD/tasks-cache/*.json`
3. **Si trouvÃ©** : Proposer modification vs crÃ©ation
4. **Si introuvable** : ProcÃ©der Ã  la crÃ©ation

### CritÃ¨res de SimilaritÃ©

- **Slug identique** : 100% match
- **Titre similaire** : >80% similitude
- **Tags communs** : >3 tags identiques
- **Parent identique** : MÃªme parent_task_id

## ğŸ—„ï¸ Validation DonnÃ©es Supabase

### Champs Obligatoires

- `title` : Non vide, <200 caractÃ¨res
- `description` : Non vide, <2000 caractÃ¨res
- `acceptance_criteria` : Format Gherkin valide
- `status` : Valeur enum valide
- `priority` : 1-5
- `type` : epic|feature|task|sub-task

### Validation des Relations

- **parent_task_id** : Doit exister si spÃ©cifiÃ©
- **prd_id** : Doit correspondre Ã  un PRD existant
- **task_number** : Auto-gÃ©nÃ©rÃ©, ne pas forcer

## ğŸ“Š Validation Architecturale

### CritÃ¨res de CohÃ©rence

1. **Guidelines** : Respecter les rÃ¨gles applicables
2. **Patterns** : Suivre les patterns Ã©tablis
3. **DÃ©pendances** : VÃ©rifier les prÃ©requis
4. **Performance** : Pas de rÃ©gression anticipÃ©e

### Checklist Automatique

- [ ] Guidelines frontend/backend respectÃ©es
- [ ] Patterns architecturaux suivis
- [ ] DÃ©pendances satisfaites
- [ ] Tests dÃ©finis
- [ ] Documentation prÃ©vue

## ğŸ¯ Utilisation

### Import dans les Fichiers

```markdown
> **Validation :** Appliquer la procÃ©dure [validation-common.mdc](mdc:fragments/validation-common.mdc)
```

### RÃ©utilisation

Toutes les validations communes doivent utiliser ce fragment plutÃ´t que d'implÃ©menter leur propre logique.

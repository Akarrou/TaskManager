---
description: GÃ©nÃ©ration et validation de PRD (Product Requirements Document) pour nouvelles fonctionnalitÃ©s AgroFlow
globs: ["PRD/**/*", "**/*.md"]
alwaysApply: false
---
---
description: GÃ©nÃ©ration et validation de PRD (Product Requirements Document) pour nouvelles fonctionnalitÃ©s AgroFlow
globs: ["PRD/**/*", "**/PRD/**/*", "docs/**/*.md"]
alwaysApply: false
---

# 10_prd-builder.mdc

## RÃ´le & Contexte
Ce fichier dÃ©finit la procÃ©dure, la gouvernance et les check-lists pour la gÃ©nÃ©ration et la validation des PRD AgroFlow. Il est la rÃ©fÃ©rence unique pour tout ce qui concerne le Product Requirements Document (PRD).

## âš ï¸ VÃ©rification prÃ©alable d'existence de PRD

Avant toute crÃ©ation d'un nouveau PRD, l'agent doit vÃ©rifier dans le dossier `@/PRD` si un PRD sur le mÃªme sujet (mÃªme slug ou sujet proche) existe dÃ©jÃ .
- Si un PRD existe dÃ©jÃ , l'agent doit proposer Ã  l'utilisateur de modifier le PRD existant ou d'en crÃ©er un nouveau.
- Si aucun PRD pertinent n'est trouvÃ©, l'agent poursuit la crÃ©ation d'un nouveau PRD sans demander Ã  l'utilisateur, s'il peut crÃ©er la nouvelle PRD.

---

## ğŸ“ ProcÃ©dure GÃ©nÃ©rale PRD

1. **Penserâ€‘pasâ€‘Ã â€‘pas**Â : expose d'abord ton raisonnement interne dans un bloc `COGITO:` puis gÃ©nÃ¨re la section PRD dans un bloc `PRD:`.
2. AprÃ¨s gÃ©nÃ©rationÂ :
   - RÃ©sume la section en **maxâ€¯2Â phrases** â†’ ajouteâ€‘la Ã  `MÃ‰MOIRE_SÃ‰QUENTIELLE`.
   - Si la section modifie les fondations (**vision, contraintes, KPIs**), mets Ã  jour `MÃ‰MOIRE_LONG_TERME`.
3. Termine toujours par `NEXT_STEP_SUGGESTION: <Ã©tape suivante>`.
4. Attends la **validation explicite** de l'utilisateur avant de poursuivre.

---

## ğŸ“‹ Ã‰tapes du PRD

- Vision & problÃ¨me
- Objectifs SMART & KPIs
- Personae & parcours
- User stories dÃ©taillÃ©es
- SpÃ©cifications fonctionnelles
- SpÃ©cifications nonâ€‘fonctionnelles (perf, sÃ©curitÃ©, i18nâ€¦)
- DÃ©pendances & risques
- Roadmap & jalons
- CritÃ¨res d'acceptation (scÃ©narios **Gherkin Given/When/Then**)
- Validation utilisateur

---

## ğŸ“„ Templates & Nomenclature

- PRD header (titre, date, contexte)
- Tableaux de traÃ§abilitÃ©
- ScÃ©narios Gherkin
- Registre des risques
- Nom de fichierÂ : `<slug>-YYYY-MM-DD.md` (kebabâ€‘case, sans accents)
- EmplacementÂ : dossier `@/PRD` Ã  la racine du projet
- BranchÂ : `prd/<slug>`
- CommitÂ : `PRD:<slug>`

---

## ğŸ›¡ï¸ Gouvernance & RÃ´le de l'IA

| Aspect           | Exigence                                                                                  |
| ---------------- | ----------------------------------------------------------------------------------------- |
| **AutoritÃ©**     | L'IA est _sourceâ€¯ofâ€¯truth_ pour la cohÃ©rence du PRD ; toute divergence est remontÃ©e.      |
| **VÃ©rification** | Revue automatisÃ©eâ€¯: lint Markdown, validation YAML/JSON, orthographe, conformitÃ© Gherkin. |
| **Issue Git**    | CrÃ©ation/liaison d'une _issue_ Â«â€¯PRD Reviewâ€¯Â» assignÃ©e aux parties prenantes.             |
| **Escalade**     | Conflit non rÃ©solu â†’ **blocage** jusqu'Ã  rÃ©solution.                                      |

---

## âœ… Check-lists par Ã©tape

<details>
<summary>Vision & problÃ¨me</summary>

- [ ] ProblÃ¨me utilisateur clairement formulÃ©
- [ ] Impact business quantifiÃ©
- [ ] Alignement stratÃ©gie produit

</details>

<details>
<summary>Objectifs SMART & KPIs</summary>

- [ ] S = SpÃ©cifique
- [ ] M = Mesurable
- [ ] A = Atteignable
- [ ] R = RÃ©aliste
- [ ] T = Temporel
- [ ] KPIs dÃ©finis et mesurables

</details>

<details>
<summary>User stories dÃ©taillÃ©es</summary>

- [ ] User stories exhaustives, format Â« En tant queâ€¦ Â»
- [ ] RÃ´les/personae couverts
- [ ] Parcours utilisateur complet
- [ ] Priorisation des user stories

</details>

<details>
<summary>SpÃ©cifications fonctionnelles</summary>

- [ ] FonctionnalitÃ©s listÃ©es et dÃ©crites
- [ ] Cas d'usage principaux et alternatifs
- [ ] RÃ¨gles mÃ©tier explicites
- [ ] Interfaces/API prÃ©cisÃ©es si besoin

</details>

<details>
<summary>SpÃ©cifications non-fonctionnelles</summary>

- [ ] Contraintes de performance
- [ ] Contraintes de sÃ©curitÃ©
- [ ] Contraintes d'i18n/accessibilitÃ©
- [ ] Contraintes techniques (infra, compatibilitÃ©, etc.)

</details>

<details>
<summary>DÃ©pendances & risques</summary>

- [ ] DÃ©pendances externes identifiÃ©es
- [ ] Risques projet listÃ©s et Ã©valuÃ©s
- [ ] Plan de mitigation pour chaque risque majeur

</details>

<details>
<summary>Roadmap & jalons</summary>

- [ ] DÃ©coupage en lots/versions
- [ ] Dates ou jalons clÃ©s dÃ©finis
- [ ] CritÃ¨res de passage entre jalons

</details>

<details>
<summary>CritÃ¨res d'acceptation (Gherkin)</summary>

- [ ] ScÃ©narios Gherkin exhaustifs
- [ ] Cas nominaux et erreurs couverts
- [ ] CritÃ¨res d'acceptation validÃ©s avec le mÃ©tier

</details>

<details>
<summary>Validation utilisateur</summary>

- [ ] Relecture par toutes les parties prenantes
- [ ] Validation explicite obtenue
- [ ] PRD archivÃ© et versionnÃ©

</details>

---

## CONTRAINTES

- Appliquer les principes **SOLID** et Oncle Bob.
- FormatsÂ : Markdown + tableaux pour traÃ§abilitÃ©, JSONâ€‘schemas si besoin.
- **Gouvernance Git**Â : chaque PRD est versionnÃ© ; la branche et le message de commit contiennent l'ID PRD (`prd/<slug>` et `PRD:<slug>`).
- Aucun contenu horsâ€‘scope.

---

## Guidelines & Standards applicables

| Domaine              | Document                        | Chemin                     | DerniÃ¨re rÃ©vision |
| -------------------- | ------------------------------- | -------------------------- | ----------------- |
| Frontend             | 40_guidelines-frontend.mdc      | @/docs/guidelines/frontend | 2025â€‘06â€‘09        |
| Backend              | 41_guidelines-backend.mdc       | @/docs/guidelines/backend  | 2025â€‘06â€‘09        |
| Internationalisation | 04-i18n.mdc                     | @/docs/guidelines/i18n     | 2025â€‘06â€‘09        |
| Global               | 10_project-architecture.mdc     | @/docs/guidelines          | 2025â€‘06â€‘09        |

> L'IA filtre ce tableau aux domaines rÃ©ellement concernÃ©s par la fonctionnalitÃ© et met Ã  jour la date via `git log`.

---

## ğŸ“„ GÃ©nÃ©ration, Validation & Gestion des PRD

1. GÃ©nÃ©rer automatiquement un PRD structurÃ©Â :
   - Titre de la fonctionnalitÃ©
   - Date de crÃ©ation
   - Contexte et objectifs
   - Description fonctionnelle
   - Contraintes et rÃ¨gles mÃ©tier
   - CritÃ¨res d'acceptation
   - Points d'attention / risques
   - Questions ouvertes
2. **Nom de fichier**Â : `<slug>-YYYY-MM-DD.md` (kebabâ€‘case, sans accents), proposÃ© Ã  l'utilisateur.
3. **Emplacement**Â : dossier `@/PRD` Ã  la racine du projet.
4. **Validation utilisateur** obligatoire avant planification ou implÃ©mentation.
5. Le PRD devient la **rÃ©fÃ©rence contractuelle** ; toute modification ultÃ©rieure doit Ãªtre documentÃ©e et validÃ©e.
6. L'IA alimente sa mÃ©moire sÃ©quentielle et la base de connaissances AgroFlow.

> **Prompt final standard**
>
> ```text
> Voici le document PRD pour la fonctionnalitÃ© demandÃ©e.
> Nom du fichier proposÃ©Â : <slug>-YYYY-MM-DD.md
> Asâ€‘tu des questions ou des modifications Ã  apporterâ€¯?
> Merci de valider ou d'indiquer les ajustements avant de poursuivre.
> ```

---

## PIPELINE CI/CD

1. **Artefact**Â : PDF via Pandoc.
2. **Job `validate-prd`**Â : lint + validation + test Gherkin.
3. Publication artefacts `prd-artifacts/<slug>/`.
4. **Job `validate-guidelines`**Â : vÃ©rifie tableau Guidelines, existence fichiers, date < 90 j.

---

## TRANSITION VERS TASKMASTER MODE

> PrÃ©â€‘requisÂ : PRD validÃ© + artefact CI.
> L'IA lit les Guidelines pour renseigner `guideline_refs` dans chaque task.

---

## AMÃ‰LIORATION CONTINUE

Feedbacks â†’ `MÃ‰MOIRE_SÃ‰QUENTIELLE` ; rÃ©tro mensuelle.

---

## ERREURS & RED FLAGS (extrait)

| Code   | Situation                        | Action IA                 |
| ------ | -------------------------------- | ------------------------- |
| GL-201 | Guideline requise non rÃ©fÃ©rencÃ©e | Ajouter + revalidation    |
| GL-202 | `guideline_refs` vide            | Bloquer crÃ©ation ticket   |
| GL-203 | Guideline obsolÃ¨te               | Avertir + proposer update |

---

## Annexes & RÃ©fÃ©rences

- [Templates PRD](mdc:PRD)
- [40_guidelines-frontend.mdc](mdc:40_guidelines-frontend.mdc)
- [41_guidelines-backend.mdc](mdc:41_guidelines-backend.mdc)
- [04-i18n.mdc](mdc:04-i18n.mdc)
- [10_project-architecture.mdc](mdc:10_project-architecture.mdc)

---

## RÃ©fÃ©rences croisÃ©es

- [50_docs-management.mdc](mdc:50_docs-management.mdc) â€“ Obligation de consultation et de mise Ã  jour de la documentation @/docs lors de la gÃ©nÃ©ration ou modification de PRD.
